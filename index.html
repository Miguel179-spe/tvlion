<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IPTV Player TV - Multi Playlist</title>
  <style>
    :root {
      --accent: #1e90ff;
      --bg: #141414;
      --text: #fff;
    }

    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow-x: hidden;
      scroll-behavior: smooth;
      transition: background 0.3s ease;
    }

    a { color: inherit; text-decoration: none; }

    .hero {
      position: relative;
      height: 70vh;
      background-size: cover;
      background-position: center;
      display: flex;
      align-items: flex-end;
      justify-content: flex-start;
      padding: 20px;
      box-sizing: border-box;
      transition: background-image 0.6s ease, transform 0.5s ease;
    }
    .hero::after {
      content: "";
      position: absolute;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: linear-gradient(to top, rgba(20,20,20,1) 20%, rgba(20,20,20,0.3) 80%);
    }
    .hero-content {
      position: relative;
      z-index: 2;
      max-width: 600px;
      animation: fadeInUp 0.8s ease;
    }
    .hero h1 { font-size: 2.4em; margin: 0; }
    .hero p { font-size: 1.1em; color: #ddd; line-height: 1.4em; margin-top: 5px; }

    .play-btn {
      margin-top: 20px;
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 12px 30px;
      font-size: 16px;
      border-radius: 50px;
      cursor: pointer;
      transition: background 0.3s, transform 0.3s, box-shadow 0.3s;
    }
    .play-btn:hover, .play-btn.focused {
      background: #339aff;
      transform: scale(1.08);
      box-shadow: 0 0 25px rgba(255,255,255,0.8);
      outline: 2px solid #fff;
    }

    .main { padding: 30px; box-sizing: border-box; }
    .section {
      margin-bottom: 40px;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }
    .section.active { transform: scale(1.02); opacity: 1; }
    .section h2 {
      font-size: 1.6em;
      margin-bottom: 20px;
      color: #fff;
    }

    .row {
      display: flex;
      overflow-x: auto;
      gap: 30px;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 8px;
    }
    .row::-webkit-scrollbar { display: none; }

    .channel {
      flex: 0 0 130px;
      cursor: pointer;
      border-radius: 10px;
      font-size: 12px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 6px 20px rgba(0,0,0,0.5);
      position: relative;
    }
    .channel:hover {
      transform: scale(1.0008);
      box-shadow: 0 0 2px rgba(255,255,255,0.6);
    }
    .channel img {
      width: 100%;
      aspect-ratio: 3/4;
      object-fit: cover;
      display: block;
      border-radius: 8px;
    }
    .channel p {
      margin-top: 6px;
      font-size: 13px;
      text-align: center;
    }
    .channel .category {
      position: absolute;
      top: 6px;
      left: 6px;
      background: rgba(255,255,255,0.9);
      padding: 1px 8px;
      font-size: 11px;
      border-radius: 4px;
      color: #000;
      font-weight: 600;
    }
    .channel.focused {
      outline: 3px solid #fff;
      box-shadow: 0 0 30px rgba(255,255,255,0.8);
      transform: scale(1.12);
    }

    @media (max-width: 900px) {
      .hero { height: 60vh; padding: 15px; }
      .hero h1 { font-size: 1.8em; }
      .hero p { font-size: 1em; }
      .channel { flex: 0 0 110px; }
    }
    @media (max-width: 600px) {
      .hero { height: 50vh; }
      .hero h1 { font-size: 1.4em; }
      .play-btn { padding: 10px 20px; font-size: 14px; }
      .channel { flex: 0 0 90px; }
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

  </style>
</head>
<body>
  <div class="hero" id="hero">
    <div class="hero-content">
      <h1 id="heroTitle">Bienvenido a IPTV Player</h1>
      <p id="heroDesc">Explora tus películas favoritas.</p>
      <button id="heroPlayBtn" class="play-btn">▶ Reproducir</button>
    </div>
  </div>

  <div class="main" id="mainContent"></div>

  <script>
    // Aquí defines tus playlists por categoría
    const PLAYLISTS = {
     "Extrenos": "https://raw.githubusercontent.com/Miguel179-spe/tvlion/refs/heads/peliculas/Extrenos.html",

      "Ciencia Ficción": "https://raw.githubusercontent.com/Miguel179-spe/tvlion/refs/heads/peliculas/Science%20Fiction.html",

      "Acción": "https://raw.githubusercontent.com/Miguel179-spe/tvlion/refs/heads/peliculas/accion.html",
      
          
      "Fantasy": "https://raw.githubusercontent.com/Miguel179-spe/tvlion/refs/heads/peliculas/Fantasy.html",

            
      "HBO": "https://raw.githubusercontent.com/Miguel179-spe/tvlion/refs/heads/peliculas/HBO1.html",
           
      
      "Apple TV": "https://raw.githubusercontent.com/Miguel179-spe/tvlion/refs/heads/peliculas/Apple.html", 
          
       
      "Netflix": "https://raw.githubusercontent.com/Miguel179-spe/tvlion/refs/heads/peliculas/Netflix.html",
             
       
      "Apple TV": "https://raw.githubusercontent.com/Miguel179-spe/tvlion/refs/heads/peliculas/accion.html",
      
             
      "Amazon Prime Video": "https://raw.githubusercontent.com/Miguel179-spe/tvlion/refs/heads/peliculas/Amazon%20Prime%20Video.html", 
      
           
       
      "Crimen": "https://raw.githubusercontent.com/Miguel179-spe/tvlion/refs/heads/peliculas/accion.html"
      
      
      
      
      // Si tienes más categorías, agrégalas así:
      // "Terror": "URL_TERROR",
      // "Comedia": "URL_COMEDIA",
      // "Estrenos": "URL_ESTRENOS",
    };

    let moviesByCategory = {};
    let currentHero = null;

    function parseM3U(text) {
      const lines = text.split("\n");
      const channels = [];
      let current = {};
      for (let line of lines) {
        line = line.trim();
        if (line.startsWith("#EXTINF:")) {
          const logo = line.match(/tvg-logo="([^"]*)"/);
          const name = line.split(",").pop();
          const cat = line.match(/group-title="([^"]*)"/);
          current.logo = logo ? logo[1] : "https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg";
          current.name = name;
          current.category = cat ? cat[1] : "Sin categoría";
        } else if (line && !line.startsWith("#")) {
          current.url = line;
          channels.push({...current});
          current = {};
        }
      }
      return channels;
    }

    async function loadPlaylist() {
      try {
        moviesByCategory = {};

        // Cargar cada playlist
        for (const category in PLAYLISTS) {
          const url = PLAYLISTS[category];
          const res = await fetch(url);
          if (!res.ok) {
            console.warn("No se pudo cargar la playlist:", category, url);
            continue;
          }
          const text = await res.text();
          const channels = parseM3U(text);
          if (channels.length > 0) {
            // Fuerza la categoría a la que corresponde esta playlist
            moviesByCategory[category] = channels.map(ch => ({
              ...ch,
              category: category
            }));
          }
        }

        // Verifica que haya al menos una categoría cargada
        const cats = Object.keys(moviesByCategory);
        if (cats.length === 0) {
          throw new Error("No se cargó ninguna playlist válida.");
        }

        renderAllCategories();

        // Establece el primer canal de la primera categoría como hero
        const firstCat = cats[0];
        const firstChannel = moviesByCategory[firstCat][0];
        setHero(firstChannel);

        initTVNavigation();
      } catch (e) {
        console.error("Error al cargar listas:", e);
        const hero = document.getElementById("hero");
        hero.style.backgroundImage = "url('https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg')";
        document.getElementById("heroTitle").innerText = "Error al cargar playlists";
        document.getElementById("heroDesc").innerText = "Verifica las URLs configuradas.";
      }
    }

    function renderAllCategories() {
      const main = document.getElementById("mainContent");
      main.innerHTML = "";
      for (const category in moviesByCategory) {
        const section = document.createElement("div");
        section.className = "section";
        section.innerHTML = `<h2>${category}</h2><div class="row" id="row_${category.replace(/\s+/g, '_')}"></div>`;
        main.appendChild(section);
        renderChannels(moviesByCategory[category], `row_${category.replace(/\s+/g, '_')}`);
      }
    }

    function renderChannels(channels, rowId) {
      const row = document.getElementById(rowId);
      row.innerHTML = "";
      channels.forEach(ch => {
        const div = document.createElement("div");
        div.className = "channel";
        div.innerHTML = `
          <img src="${ch.logo}" alt="${ch.name}">
          <p>${ch.name}</p>
        `;
        div.onclick = () => playChannel(ch.url);
        div.onmouseenter = () => updateHeroPreview(ch);
        div.onmouseleave = () => restoreHero();
        row.appendChild(div);
      });
    }

    function setHero(ch) {
      currentHero = ch;
      const hero = document.getElementById("hero");
      hero.style.backgroundImage = `url('${ch.logo}')`;
      document.getElementById("heroTitle").innerText = ch.name;
      document.getElementById("heroDesc").innerText = `Categoría: ${ch.category}`;
      document.getElementById("heroPlayBtn").onclick = () => playChannel(ch.url);
    }

    function updateHeroPreview(ch) {
      const hero = document.getElementById("hero");
      hero.style.backgroundImage = `url('${ch.logo}')`;
      document.getElementById("heroTitle").innerText = ch.name;
      document.getElementById("heroDesc").innerText = `Categoría: ${ch.category}`;
    }

    function restoreHero() {
      if (currentHero) setHero(currentHero);
    }

    function playChannel(url) {
      // Abre en nueva pestaña. Si prefieres embebido, se debe cambiar a <video> o <iframe>.
      window.open(url, "_blank");
    }

    let focusedRow = -1;
    let focusedCol = 0;
    let sectionElements = [];

    function initTVNavigation() {
      sectionElements = Array.from(document.querySelectorAll(".section .row"));
      focusedRow = -1;
      focusedCol = 0;
      updateFocus();
    }

    function updateFocus() {
      document.querySelectorAll(".focused").forEach(el => el.classList.remove("focused"));
      if (focusedRow === -1) {
        document.getElementById("heroPlayBtn").classList.add("focused");
        document.querySelector(".hero").scrollIntoView({ behavior: "smooth" });
      } else {
        const row = sectionElements[focusedRow];
        if (!row) return;
        const channels = row.querySelectorAll(".channel");
        const channel = channels[focusedCol];
        if (!channel) return;
        channel.classList.add("focused");
        channel.scrollIntoView({ behavior: "smooth", inline: "center", block: "nearest" });
        row.parentElement.classList.add("active");
      }
    }

    document.addEventListener("keydown", e => {
      let handled = true;
      switch (e.key) {
        case "ArrowRight": focusedCol++; break;
        case "ArrowLeft": focusedCol--; break;
        case "ArrowDown": focusedRow++; break;
        case "ArrowUp": focusedRow--; break;
        case "Enter":
        case "OK":
          if (focusedRow === -1) {
            if (currentHero) playChannel(currentHero.url);
          } else {
            const row = sectionElements[focusedRow];
            const item = row?.querySelectorAll(".channel")[focusedCol];
            if (item) item.click();
          }
          break;
        default:
          handled = false;
      }
      if (!handled) return;

      if (focusedRow < -1) focusedRow = -1;
      if (focusedRow >= sectionElements.length) focusedRow = sectionElements.length - 1;

      const currentRow = sectionElements[focusedRow];
      if (focusedRow >= 0 && currentRow) {
        const totalCols = currentRow.querySelectorAll(".channel").length;
        if (focusedCol < 0) focusedCol = 0;
        if (focusedCol >= totalCols) focusedCol = totalCols - 1;
      }

      updateFocus();
      e.preventDefault();
    });

    document.addEventListener("DOMContentLoaded", loadPlaylist);

    // Puedes activar auto-actualización si lo deseas
    // setInterval(loadPlaylist, 15 * 60 * 1000); // por ejemplo cada 15 min
  </script>
</body>
</html>







