<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Series+ - Plataforma de Streaming</title>
<style>
:root {
    --primary-color: #7b2dff;
    --background-dark: #000;
    --background-card: #111;
    --background-secondary: #222;
    --text-light: #fff;
    --accent-red: #e50914;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: 'Segoe UI', Arial, sans-serif;
    background: var(--background-dark);
    color: var(--text-light);
}

/* HEADER */
header {
    padding: 15px;
    background: rgba(0,0,0,0.8);
    position: sticky;
    top: 0;
    display: flex;
    gap: 15px;
    align-items: center;
    z-index: 10;
}

.logo { font-weight: bold; font-size: 1.5rem; color: var(--primary-color); }

header input {
    flex: 1;
    padding: 12px 15px;
    border-radius: 8px;
    border: none;
    background: var(--background-secondary);
    color: var(--text-light);
    font-size: 1rem;
}

/* CARDS */
.grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 15px;
    padding: 20px;
}

.card {
    background: var(--background-card);
    border-radius: 10px;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.3s ease, outline 0.3s ease;
    position: relative;
}

.card img { width: 100%; height: 200px; object-fit: cover; }
.card-title { padding: 12px; font-size: 0.9rem; font-weight: 500; }

.card.focused {
    outline: 3px solid var(--primary-color);
    transform: scale(1.06);
}

/* BADGES */
.badge {
    position: absolute;
    top: 8px;
    left: 8px;
    background: var(--accent-red);
    padding: 4px 10px;
    font-size: 0.7rem;
    border-radius: 5px;
    font-weight: bold;
}
.badge.doblado { background: #5a42f5; }

/* MODAL */
.modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.95);
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 200;
    padding: 20px;
}

.modal video {
    max-width: 100%;
    max-height: 100%;
    border-radius: 10px;
}

.modal .episodios-grid {
    margin-top: 15px;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: center;
}

.modal .episodio {
    background: var(--background-secondary);
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9rem;
    color: var(--text-light);
    transition: 0.2s;
}

.modal .episodio.focused {
    outline: 2px solid var(--primary-color);
    transform: scale(1.12);
}

.modal .episodio.activo { background: var(--primary-color); }
.modal .episodio.bloqueado { opacity: 0.4; cursor: not-allowed; }

.next-btn {
    margin-top: 20px;
    background: var(--primary-color);
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: bold;
}

.close {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 2rem;
    cursor: pointer;
}
</style>
</head>
<body>

<header>
    <div class="logo">SERIES</div>
    <input type="text" placeholder="Buscar series...">
</header>

<section class="grid">
    <article class="card" data-series="serie-ejemplo">
        <span class="badge">Nuevo</span>
        <img src="https://www.themoviedb.org/t/p/w1280/ef2QSeBkrYhAdfsWGXmp0lvH0T1.jpg">
        <div class="card-title">Serie Ejemplo</div>
    </article>

    <article class="card" data-series="Yes Minister">
        <span class="badge doblado">Doblado</span>
        <img src="https://www.themoviedb.org/t/p/w1280/h5kF0rJaCWuF3nMBTT6IeRU8j2D.jpg">
        <div class="card-title">Yes Minister</div>
    </article>

    <article class="card" data-series="ciencia-ficcion">
        <img src="https://www.themoviedb.org/t/p/w1280/m1jFoahEbeQXtx4zArT2FKdbNIj.jpg">
        <div class="card-title">Ciencia Ficción</div>
    </article>

    <article class="card" data-series="misterios-nocturnos">
        <span class="badge">Nuevo</span>
        <img src="https://www.themoviedb.org/t/p/w1280/kGLgaDrYWmTAdRFzGP5pBquRnhO.jpg">
        <div class="card-title">Misterios Nocturnos</div>
    </article>
</section>

<!-- MODAL -->
<div class="modal" id="modal">
    
    <video id="player" controls></video>

    <div class="episodios-grid" id="episodios"></div>

    
</div>

<script>
/* ------- SERIES DATA ------- */
const seriesData = {
   
    "serie-ejemplo": [
        { title: "Episodio 1", url: "https://archive.org/download/el-abismo-secreto_202511/El%20abismo%20secreto.mp4" },
        { title: "Episodio 2", url: "https://archive.org/download/el-abismo-secreto_202511/El%20abismo%20secreto.mp4" },
        { title: "Episodio 3", url: "https://archive.org/" , locked: true }
    ],
  
  
    "Yes Minister": [
        { title: "Capítulo 1", url: "https://archive.org/download/el-abismo-secreto_202511/El%20abismo%20secreto.mp4" },
        { title: "Capítulo 2", url: "https://archive.org/download/sample-mp4-file_202511/sample.mp4" },
        { title: "Capítulo 3", url: "", locked: true }
    ],
   
   
   
    "ciencia-ficcion": [
        { title: "Episodio 1", url: "https://archive.org/download/sample-mp4-file_202511/sample.mp4" },
        { title: "Episodio 2", url: "https://archive.org/download/sample-mp4-file_202511/sample.mp4" }
    ],
   
   
   
   
    "misterios-nocturnos": [
        { title: "Episodio 1", url: "https://archive.org/download/sample-mp4-file_202511/sample.mp4" }
    ]
};

/* ------- TV NAVIGATION HOME ------- */
const cards = [...document.querySelectorAll(".card")];
let index = 0;

function focusCard() {
    cards.forEach(c => c.classList.remove("focused"));
    cards[index].classList.add("focused");
    cards[index].scrollIntoView({ behavior: "smooth", block: "nearest", inline: "center" });
}
focusCard();

document.addEventListener("keydown", e => {
    const gridWidth = Math.floor(document.querySelector(".grid").offsetWidth / cards[0].offsetWidth);

    if (modal.style.display === "flex") return; // no navegar en fondo

    if (e.key === "ArrowRight") index = (index + 1) % cards.length;
    if (e.key === "ArrowLeft") index = (index - 1 + cards.length) % cards.length;
    if (e.key === "ArrowDown") index = Math.min(index + gridWidth, cards.length - 1);
    if (e.key === "ArrowUp") index = Math.max(index - gridWidth, 0);
    if (e.key === "Enter") cards[index].click();

    focusCard();
});

/* ------- MODAL ------- */
const modal = document.getElementById("modal");
const player = document.getElementById("player");
const episodiosDiv = document.getElementById("episodios");
const nextBtn = document.getElementById("nextBtn");
const closeBtn = document.querySelector(".close");

let currentSeries = null;
let currentEpisode = 0;
let episodioEls = [];

cards.forEach(card => {
    card.addEventListener("click", () => {
        currentSeries = card.dataset.series;
        currentEpisode = 0;
        openModal();
    });
});

function openModal() {
    modal.style.display = "flex";
    loadEpisodes();
    playEpisode(0);

    // ⏳ Pantalla completa INMEDIATA si el usuario hace click
    if (player.requestFullscreen) player.requestFullscreen();

    // ⏳ Pantalla completa AUTOMÁTICA después de 15 segundos
    setTimeout(() => {
        if (modal.style.display === "flex") {
            if (player.requestFullscreen) player.requestFullscreen();
            else if (player.webkitRequestFullscreen) player.webkitRequestFullscreen();
            else if (player.msRequestFullscreen) player.msRequestFullscreen();
        }
    }, 15000);
}

/* ------- LOAD EPISODES ------- */
function loadEpisodes() {
    episodiosDiv.innerHTML = "";
    episodioEls = [];

    seriesData[currentSeries].forEach((ep, i) => {
        const div = document.createElement("div");
        div.textContent = ep.title;
        div.classList.add("episodio");
        if (ep.locked) div.classList.add("bloqueado");

        div.addEventListener("click", () => playEpisode(i));

        episodiosDiv.append(div);
        episodioEls.push(div);
    });

    focusEpisode(0);
}

function playEpisode(i) {
    const ep = seriesData[currentSeries][i];

    if (ep.locked) return alert("Episodio bloqueado");
    currentEpisode = i;

    player.src = ep.url;
    player.play();

    episodioEls.forEach(e => e.classList.remove("activo"));
    episodioEls[i].classList.add("activo");
    focusEpisode(i);

    nextBtn.style.display = (seriesData[currentSeries][i + 1]) ? "block" : "none";
}

/* ------- EPISODE FOCUS NAVIGATION ------- */
let epIndex = 0;

function focusEpisode(i) {
    epIndex = i;
    episodioEls.forEach(e => e.classList.remove("focused"));
    episodioEls[i].classList.add("focused");
}

document.addEventListener("keydown", e => {
    if (modal.style.display !== "flex") return;

    if (e.key === "ArrowRight") {
        epIndex = Math.min(epIndex + 1, episodioEls.length - 1);
        focusEpisode(epIndex);
    }
    if (e.key === "ArrowLeft") {
        epIndex = Math.max(epIndex - 1, 0);
        focusEpisode(epIndex);
    }
    if (e.key === "Enter") {
        episodioEls[epIndex].click();
    }
    if (e.key === "Backspace") closeModal();
});

/* ------- NEXT EPISODE ------- */
nextBtn.addEventListener("click", () => {
    if (seriesData[currentSeries][currentEpisode + 1]) {
        playEpisode(currentEpisode + 1);
        focusEpisode(currentEpisode);
    }
});

/* ------- CLOSE MODAL ------- */
function closeModal() {
    modal.style.display = "none";
    player.pause();
}

closeBtn.addEventListener("click", closeModal);

window.addEventListener("keydown", e => {
    if (e.key === "Backspace" && modal.style.display === "flex") closeModal();
});
</script>

</body>
</html>

